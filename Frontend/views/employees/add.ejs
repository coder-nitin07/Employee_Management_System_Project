
<%- include('../partials/header', { title: 'Add Employee' }) %>

<div style="width: 400px; margin: 40px auto;">
    <h2>Add New Employee</h2>

    <form action="http://localhost:4000/api/createEmployee" method="POST" enctype="multipart/form-data" id="addEmployeeForm">
        <label for="name">Name *</label>
        <br />

        <input type="text" id="name" name="name" required />
        <br /><br />

        <label for="email">Email *</label>
        <br />

        <input type="email" id="email" name="email" required />
        <br /><br />

        <label for="mobile">Mobile *</label>
        <br />

        <input type="text" name="mobile" id="mobile" maxlength="10" required />
        <br /><br />

        <label for="designation">Designation *</label>
        <br />

        <select name="designation" id="designation">
            <option value="">Select Designation</option>
            <option value="HR">HR</option>
            <option value="Manager">Manager</option>
            <option value="Sales">Sales</option>
        </select>
        <br /><br />

        <label for="Gender *"></label>

        <input type="radio" name="gender" id="male" value="male" required />
        <label for="male">Male</label>
        <input type="radio" name="gender" id="female" value="female" required />
        <label for="female">Female</label>
        <br /><br />

        <label>Course(s) *</label><br/>
        <input type="checkbox" id="mca" name="course" value="MCA" />
        <label for="mca">MCA</label>
        <input type="checkbox" id="bca" name="course" value="BCA" />
        <label for="bca">BCA</label>
        <input type="checkbox" id="bsc" name="course" value="BSC" />
        <label for="bsc">BSC</label>
        <br /><br />

        <label for="image">Portfolio Image *</label>
        <input type="file" name="image" id="image" accept="image/*" required />
        <br /><br />

        <button type="submit">Add Employee</button>
    </form>
</div>

<script>
    $(document).ready(function () {
        $('#addEmployeeForm').submit(function (e) {
            e.preventDefault(); // prevent default form submit
            
            const form = $('#addEmployeeForm')[0];
            const formData = new FormData(form);
            
            $.ajax({
        url: 'http://localhost:4000/api/createEmployee',
        type: 'POST',
        data: formData,
        contentType: false,
        processData: false,
        headers: {
          Authorization: 'Bearer ' + localStorage.getItem('token')
        },
        success: function (response) {
            alert('Employee added successfully!');
          window.location.href = '/employees'; // redirect to list page
        },
        error: function (xhr) {
          const errorMessage = xhr.responseJSON?.message || 'Failed to add employee';
          alert(errorMessage);
        }
    });
});
});
</script>

<script src="/js/validation.js"></script>

<%- include('../partials/footer') %>